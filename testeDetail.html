<!DOCTYPE html>
<html lang="en">

<head>
    <title>Minha Página</title>
    <link rel="stylesheet" type="text/css" href="testeDetail.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
        crossorigin="anonymous">
    <style>
        body {
            background: url('loginiablur1.jpg') no-repeat center center fixed;
            background-size: cover;

        }

        .card-body {
            min-height: 300px;
        }

        .card {
            min-height: 300px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="main-body">

            <!-- Breadcrumb -->

            <!-- /Breadcrumb -->

            <div class="row gutters-sm">
                <div class="col-md-4 mb-3">
                    <div class="card">
                        <div class="card-body">
                            <div class="d-flex flex-column align-items-center text-center">
                                <img src="https://th.bing.com/th/id/R.ffd1159560034236405343f0872728a8?rik=0TVa67ILbMyevQ&pid=ImgRaw&r=0"
                                    alt="Admin" class="rounde-circle" width="200">
                                <div id="characterName" class="mt-3">
                                    <!-- Nome do personagem será preenchido dinamicamente -->
                                </div>
                                <div id="journal" class="mt-3">
                                    <!-- Conteúdo do jornal será preenchido dinamicamente -->
                                </div>
                                <div id="attributePoints" class="mt-3">
                                    <!-- Conteúdo dos pontos de atributo será preenchido dinamicamente -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card mt-3">
                        <ul class="list-group list-group-flush">

                        </ul>
                    </div>
                </div>
                <div class="col-md-8">
                    <div class="card mb-3">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Background</h6>
                                </div>
                                <div class="col-sm-9 text-secondary" id="background"></div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Alignment</h6>
                                </div>
                                <div class="col-sm-9 text-secondary" id="alignment"></div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Race</h6>
                                </div>
                                <div class="col-sm-9 text-secondary" id="race"></div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Class</h6>
                                </div>
                                <div class="col-sm-9 text-secondary" id="class"></div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Level</h6>
                                </div>
                                <div class="col-sm-9 text-secondary" id="level"></div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-12">
                                    <a class="btn btn-info " target="__blank"
                                        href="https://www.bootdey.com/snippets/view/profile-edit-data-and-skills">Edit</a>
                                </div>
                            </div>
                        </div>
                    </div>



                    <div class="row gutters-sm">
                        <div class="col-sm-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body">
                                    <h4></h4>
                                    <div class="table-responsive">
                                        <table class="table table-bordered">
                                            <thead>
                                                <tr>
                                                    <th>Items</th>
                                                </tr>
                                            </thead>
                                            <!-- Dados da tabela serão preenchidos dinamicamente aqui -->
                                            <tbody id="itemsTableBody"></tbody>
                                        </table>

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body">
                                    <div class="spells-container">
                                        <h4></h4>
                                        <div class="table-responsive">
                                            <table class="table table-bordered">
                                                <thead>
                                                    <tr>
                                                        <th>Spells</th>
                                                    </tr>
                                                </thead>
                                                <!-- Dados da tabela serão preenchidos dinamicamente aqui -->
                                                <tbody id="spellsTableBody"></tbody>
                                            </table>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

        </div>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
            crossorigin="anonymous"></script>
        <script>
            // Chame as funções para preencher as tabelas quando a página carregar
            window.onload = function () {
                fetchProfileData();
                fetchItems();
                fetchSpells();
                fetchJournal();
                fetchAttributePoints();
            };

            function fetchProfileData() {
                idCharacter = localStorage.getItem('idCharacter');
                const apiUrl = `http://localhost:8080/characters/${idCharacter}`;

                fetch(apiUrl)
                    .then(response => response.json())
                    .then(data => {
                        document.getElementById('characterName').textContent = data.characterName;
                        document.getElementById('background').textContent = data.background;
                        document.getElementById('alignment').textContent = data.alignment;
                        document.getElementById('race').textContent = data.race;
                        document.getElementById('class').textContent = data.class_;
                        document.getElementById('level').textContent = data.level;
                    })
                    .catch(error => console.error('Erro ao obter dados do perfil:', error));
            }

            // Função para preencher a tabela de Items com dados da requisição
            function fetchItems() {
                // Substitua a URL abaixo pela sua URL de API
                idCharacter = localStorage.getItem('idCharacter');
                const apiUrl = `http://localhost:8080/items/${idCharacter}`;

                fetch(apiUrl)
                    .then(response => response.json())
                    .then(data => {
                        const itemsTableBody = document.getElementById('itemsTableBody');

                        // Limpe a tabela antes de adicionar novos itens
                        itemsTableBody.innerHTML = '';

                        // Itere sobre os dados e preencha a tabela
                        data.forEach(item => {
                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td class="item-name" data-toggle="modal" data-target="#descriptionModal" data-description="${item.description}">${item.name}</td>
                            `;
                            itemsTableBody.appendChild(row);
                        });
                    })
                    .catch(error => console.error('Erro ao obter dados de Items:', error));
            }

            // Função para preencher a tabela de Spells com dados da requisição
            function fetchSpells() {
                idCharacter = localStorage.getItem('idCharacter');
                const apiUrl = `http://localhost:8080/spells/${idCharacter}`;

                fetch(apiUrl)
                    .then(response => response.json())
                    .then(data => {
                        const spellsTableBody = document.getElementById('spellsTableBody');

                        // Limpe a tabela antes de adicionar novos itens
                        spellsTableBody.innerHTML = '';

                        // Itere sobre os dados e preencha a tabela
                        data.forEach(spell => {
                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td class="spell-name" data-toggle="modal" data-target="#descriptionModal" data-description="${spell.description}">${spell.name}</td>
                            `;
                            spellsTableBody.appendChild(row);
                        });
                    })
                    .catch(error => console.error('Erro ao obter dados de Spells:', error));
            }

            // Função para preencher o jornal com dados da requisição
            function fetchJournal() {
                idCharacter = localStorage.getItem('idCharacter');
                const apiUrl = `http://localhost:8080/journal/${idCharacter}`;

                fetch(apiUrl)
                    .then(response => response.json())
                    .then(data => {
                        document.getElementById('journal').textContent = data.journalText;
                    })
                    .catch(error => console.error('Erro ao obter dados do jornal:', error));
            }

            // Função para preencher os pontos de atributo com dados da requisição
            function fetchAttributePoints() {
                idCharacter = localStorage.getItem('idCharacter');
                const apiUrl = `http://localhost:8080/atributepoints/${idCharacter}`;

                fetch(apiUrl)
                    .then(response => response.json())
                    .then(data => {
                        document.getElementById('attributePoints').textContent = JSON.stringify(data);
                    })
                    .catch(error => console.error('Erro ao obter dados dos pontos de atributo:', error));
            }

            // Exibir a descrição no modal ao clicar no nome do item ou spell
            $('#descriptionModal').on('show.bs.modal', function (event) {
                const button = $(event.relatedTarget);
                const description = button.data('description');
                const modal = $(this);
                modal.find('.modal-body #descriptionContent').text(description);
            });
        </script>
</body>

</html>
